{% extends 'travel/base.html' %}

{% block title %}
    <title>Dashboard</title>
{% endblock title %}

{% block content %}



  <div class="container">
      <h1 style="text-align:center" class="mt-4 ">Dashboard</h1>
      <div class="container">
          <div class="row">
              <div class="col-3">
                <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                  {% if user.is_superuser %}
                  <a class="nav-link active" id="v-pills-home-tab" data-toggle="pill" href="#v-pills-home" role="tab" aria-controls="v-pills-home" aria-selected="true">ข้อมูลผู้ใช้งาน</a>
                  <a class="nav-link" id="v-pills-profile-tab" data-toggle="pill" href="#v-pills-profile" role="tab" aria-controls="v-pills-profile" aria-selected="false">การจัดการชำระเงิน</a>
                  {% endif %}
                  <a class="nav-link" id="v-pills-messages-tab" data-toggle="pill" href="#v-pills-messages" role="tab" aria-controls="v-pills-messages" aria-selected="false">การจัดการโพส</a>
                </div>
              </div>
              <div class="col-9">
                <div class="tab-content" id="v-pills-tabContent">
                  <div class="tab-pane fade show active" id="v-pills-home" role="tabpanel" aria-labelledby="v-pills-home-tab">
                      {% if user.is_superuser %}
                      <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                          <li class="nav-item">
                            <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">User</a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">Guide</a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">Admin</a>
                          </li>
                      </ul>
                      {% endif %}

                      {% if user.is_superuser %}
                      <!-- start user -->

                      <div class="tab-content" id="pills-tabContent">

                          <!-- start user_u -->

                          <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                              <table class="table table-striped">
                                  <thead>

                                    <tr>
                                      <th scope="col">Username</th>
                                      <th scope="col">First Name</th>
                                      <th scope="col">Last name</th>
                                      <th scope="col">E-mail</th>
                                      <th scope="col"></th>
                                      <th scope="col"></th>
                                    </tr>
                                  {% for item in user_u %}
                                  </thead>
                                  <tbody>
                                    <tr>
                                        <td>{{item.username}}</td>
                                        <td>{{item.first_name}}</td>
                                        <td>{{item.last_name}}</td>
                                        <td>{{item.email}}</td>
                                        <td>
                                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#edit-{{ item.username }}">
                                                <i class="fa fa-pencil" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                        <td>
                                            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#delete-{{ item.username }}">
                                                <i class="fa fa-trash" aria-hidden="true"></i>
                                            </button>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                  </tbody>
                              </table>
                          </div>

                          <!-- End user_u -->

                          <!-- start user_g -->

                          <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                              <table class="table table-striped">
                                  <thead>
                                    <tr>
                                        <th scope="col">Username</th>
                                      <th scope="col">First Name</th>
                                      <th scope="col">Last name</th>
                                      <th scope="col">E-mail</th>
                                        <th scope="col"></th>
                                    </tr>
                                  {% for item in user_g %}
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td>{{item.username}}</td>
                                      <td>{{item.first_name}}</td>
                                      <td>{{item.last_name}}</td>
                                      <td>{{item.email}}</td>
                                      <td>
                                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#edit-{{ item.username }}">
                                                <i class="fa fa-pencil" aria-hidden="true"></i>
                                            </button>
                                      </td>
                                      <td>
                                            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#delete-{{ item.username }}">
                                                <i class="fa fa-trash" aria-hidden="true"></i>
                                            </button>
                                      </td>
                                    </tr>{% endfor %}
                                  </tbody>
                              </table>
                          </div>

                          <!-- End user_g -->

                          <!-- start user_a -->

                          <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">
                              <table class="table table-striped">
                                  <thead>
                                    <tr>
                                      <th scope="col">Username</th>
                                      <th scope="col">First Name</th>
                                      <th scope="col">Last name</th>
                                      <th scope="col">E-mail</th>
                                      <th scope="col"></th>
                                      <th scope="col"></th>
                                    </tr>
                                  {% for item in user_a %}
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td>{{item.username}}</td>
                                      <td>{{item.first_name}}</td>
                                      <td>{{item.last_name}}</td>
                                      <td>{{item.email}}</td>
                                      <td>
                                          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#edit-{{ item.username }}">
                                            <i class="fa fa-pencil" aria-hidden="true"></i>
                                          </button>
                                      </td>
                                      <td>
                                            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#delete-{{ item.username }}">
                                                <i class="fa fa-trash" aria-hidden="true"></i>
                                            </button>
                                      </td>
                                    </tr>{% endfor %}

                                  </tbody>
                              </table>
                          </div>

                          <!-- End user_a -->
                      </div>

                      <!-- End User -->

                  </div>

                <!--start payment-->

                  <div class="tab-pane fade" id="v-pills-profile" role="tabpanel" aria-labelledby="v-pills-profile-tab">
                      <table class="table table-striped">
                          <thead>
                            <tr>
                              <th scope="col">user</th>
                              <th scope="col">trip</th>
                              <th scope="col">photo</th>

                            </tr>
                          </thead>
                          <tbody>
                            {% for all in booking %}
                            <tr>
                              <td>{{all.user.username}}</td>
                              <td>{{all.trip.title}}</td>
                              <td>
                                  <a href="#" data-target="#modalIMG{{all.id}}" data-toggle="modal" class="color-gray-darker c6 td-hover-none">
                                    <img src="{{all.image_pay.url}}" height="10%" width="10%">
                                  </a>
                              </td>
                            </tr>
                           {% endfor %}
                          </tbody>
                      </table>
                  </div>
                    {% endif %}

                <!--end payment-->

                <!--start trip-->

                  <div class="tab-pane fade" id="v-pills-messages" role="tabpanel" aria-labelledby="v-pills-messages-tab">
                      <table class="table table-striped">
                          <thead>
                            <tr>
                              <th scope="col">Username </th>
                              <th scope="col">title</th>
                              <th scope="col">place</th>
                              <th scope="col">phone</th>
                              <th scope="col">date</th>
                              <th scope="col">time_start</th>
                              <th scope="col">time_end</th>
                              <th scope="col">booking_status</th>
                            </tr>

                          </thead>
                          <tbody>
                          {% if user.is_superuser and user.is_staff %}
                            {% for all in trip %}
                                <tr>
                                  <td>{{all.user}}</td>
                                  <td>{{all.title}}</td>
                                  <td>{{all.place}}</td>
                                  <td>{{all.phone}}</td>
                                  <td>{{all.date}}</td>
                                  <td>{{all.time_start}}</td>
                                  <td>{{all.time_end}}</td>
                                  <td>{% if all.booking_status %}  ว่าง {% else %}  ถูกจองแล้ว {% endif %}</td>
                                  <td>
                                      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#update-{{ item.trip }}">
                                          <i class="fa fa-pencil" aria-hidden="true"></i>
                                      </button>
                                  </td>
                                  <td>
                                      <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#delete-{{ item.trip }}">
                                          <i class="fa fa-trash" aria-hidden="true"></i>
                                      </button>
                                  </td>
                                </tr>
                            {% endfor %}
                          {% endif %}


                          {% if user.is_staff and not is_superuser %}
                            {% for item in trip_g %}
                                <tr>
                                  <td>{{item.user}}</td>
                                  <td>{{item.title}}</td>
                                  <td>{{item.place}}</td>
                                  <td>{{item.phone}}</td>
                                  <td>{{item.date}}</td>
                                  <td>{{item.time_start}}</td>
                                  <td>{{item.time_end}}</td>
                                  <td>{% if .item.booking_status %}  ว่าง {% else %}  ถูกจองแล้ว {% endif %}</td>
                                  <td>
                                  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#update-{{ item.trip }}">
                                      <i class="fa fa-pencil" aria-hidden="true"></i>
                                  </button>
                              </td>
                                  <td>
                                  <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#delete-{{ item.trip }}">
                                      <i class="fa fa-trash" aria-hidden="true"></i>
                                  </button>
                              </td>
                                 </tr>
                            {% endfor %}
                          {% endif %}
                          </tbody>
                      </table>
                  </div>

                <!--end trip-->

                </div>
              </div>
          </div>

      </div>
  </div>


<!-- Modal Edit user -->

    {% for item in users %}
    <div class="modal fade" id="edit-{{ item.username }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Edit</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
            <form action="/users/{{ item.username }}" method="POST">
                <div class="modal-body">
                  {% csrf_token %}
                  <div class="form-group">
                      <label for="txtFirstname">First name</label>
                      <input type="text" id="txtFirstname" name="first_name" class="form-control" value="{{ item.first_name }}">
                  </div>
                  <div class="form-group">
                      <label for="txtLastname">Last name</label>
                      <input type="text" id="txtLastname" name="last_name" class="form-control" value="{{ item.last_name }}">
                  </div>
                  <div class="form-group">
                      <label for="txtEmail">Email</label>
                      <input type="text" id="txtEmail" name="email" class="form-control" value="{{ item.email }}">
                  </div>
              </div>
              <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">Save changes</button>
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
            </form>
        </div>
      </div>
    </div>
    {% endfor %}

<!--End Modal-->


<!-- Modal Delete user -->

    {% for item in users %}
    <div class="modal fade" id="delete-{{ item.username }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form action="/users/delete/{{ item.username }}" method="POST">
              <div class="modal-body">
                  {% csrf_token %}
                Do you confirm to delete this user?
              </div>
              <div class="modal-footer">
                <button type="Submit" class="btn btn-danger">Delete</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}

<!--End Modal-->


<!-- Modal edit trip-->

    {% for item in trip %}
    <div class="modal fade" id="update-{{ item.trip }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Update Trip</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form action="{% url 'trips-update' id=item.id %}" method="POST">
                <div class="modal-body">
                  {% csrf_token %}
                  <div class="form-group">
                      <label for="txtFirstname">Title</label>
                      <input type="text" id="txtFirstname" name="title" class="form-control" value="{{ item.title }}">
                  </div>
                  <div class="form-group">
                      <label for="txtLastname">Place</label>
                      <input type="text" id="txtLastname" name="place" class="form-control" value="{{ item.place }}">
                  </div>
                  <div class="form-group">
                      <label for="txtEmail">Phone</label>
                      <input type="tel" id="txtEmail" name="phone" class="form-control" value="{{ item.phone }}">
                  </div>
                  <div class="form-group">
                      <label for="txtEmail">date</label>
                      <input type="date" id="txtEmail" name="date" class="form-control" value="{{ item.date }}">
                  </div>
                  <div class="form-group">
                      <label for="txtEmail">time_start</label>
                      <input type="time" id="txtEmail" name="time_start" class="form-control" value="{{ item.time_start }}">
                  </div>
                  <div class="form-group">
                      <label for="txtEmail">time_end</label>
                      <input type="time" id="txtEmail" name="time_end" class="form-control" value="{{ item.time_end }}">
                  </div>
              </div>
              <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">Save changes</button>
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}

<!--End Modal-->


<!-- Modal Delete trip -->

    {% for item in trip %}
    <div class="modal fade" id="delete-{{ item.trip }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Delete Trip</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form action="{% url 'trips-delete' id=item.id %}" method="POST">
              <div class="modal-body">
                  {% csrf_token %}
                Do you confirm to delete this Trip?
              </div>
              <div class="modal-footer">
                <button type="Submit" class="btn btn-danger">Delete</button>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              </div>
          </form>
        </div>
      </div>
    </div>
    {% endfor %}

<!--End Modal-->


<!-- start modal image -->
    {% for all in booking %}
        <div aria-hidden="true" aria-labelledby="myModalLabel" class="modal fade" id="modalIMG{{all.id}}" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-body mb-0 p-0">
                        <img src="{{all.image_pay.url}}" alt="" style="width:100%">
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-outline-primary btn-rounded btn-md ml-4 text-center" data-dismiss="modal" type="button">Close</button>
                    </div>
                </div>

            </div>
        </div>
    {% endfor %}

<!-- end modal image -->




{% endblock content %}